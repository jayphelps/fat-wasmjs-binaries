<script>
  async function main() {
    const req = fetch('main.wasm');
    const module = await WebAssembly.compileStreaming(req);
    const [section] = WebAssembly.Module.customSections(module, 'wasmjs');

    // JS files can actually contain non-ASCII symbols so
    // using String.fromCharCode wouldn't work in those cases
    const decoder = new TextDecoder();
    const js = decoder.decode(section);
    const start = new Function('WASM_MODULE', js);
    start(module);
  }

  main();
</script>
